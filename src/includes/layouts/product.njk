{% include "partials/header.njk" %}

<article class="product-page pt-xlarge">
  <div class="container">
    <div class="bg-light-1 rounded-md p-5">
      <div class="p-md-3">

      <div class="product-main row">
        <div class="col-md-6 product-gallery">
          <a href="{{ productImage | url }}" class="lightbox-trigger" data-no-swup data-lightbox-src="{{ productImage | url }}">
            <img src="{{ productImage }}" alt="{{ title }}" class="main-image">
          </a>
          {% if galleryImages and galleryImages.length %}
            <div class="gallery-thumbs">
              {% for image in galleryImages %}
                <a href="{{ image | url }}" class="lightbox-trigger" data-lightbox-src="{{ image | url }}">
                  <img src="{{ image }}" alt="{{ title }} - {{ loop.index }}" class="thumb-image rounded-md">
                </a>
              {% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="col-md-6 product-info">
          <nav class="breadcrumb">
            <a href="{{ langPrefix }}/">Strona główna</a> |  
            {% for cat in categories %}
              <a href="{{ langPrefix }}/produkty/{{ cat | slugify }}/">{{ cat }}</a>{% if not loop.last %} , {% endif %}
            {% endfor %}
          </nav>

          <h1 class="h2 product-title">{{ title }}</h1>

          <div class="product-price h2">
            <span class="amount">{{ price }}</span>
            <span class="currency">PLN</span>
          </div>

          <div class="product-status">
            <div class="product-short-description">
              {{ description }}
            </div>
            <p class="vin-notice">
              <strong>Uwaga:</strong> Skontaktuj się z nami, podając numer VIN pojazdu oraz prześlij zdjęcie miejsca montażu, aby sprawdzić kompatybilność.
            </p>
          </div>

          <div class="actions">
            <a href="https://ore4x4.pl/pl/103-hardtopy-zabudowy" title="Przejdź do sklepu" class="button-anim btn-write magnetic mt-2 fade-in" data-strength="40">
              <div class="button-anim-text">
                <span>Przejdź do sklepu</span>
                <span>Przejdź do sklepu</span>
              </div>
              <div class="button-anim-icon">
                <svg height="18" viewBox="0 0 100 100" width="18" xmlns="http://www.w3.org/2000/svg" class="icon-link" style="enable-background:new 0 0 100 100" version="1.1" x="0px" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px">
                  <g>
                    <path d="M83.3,79.7c0,2-1.6,3.6-3.6,3.6H20.3c-2,0-3.6-1.6-3.6-3.6V20.3c0-2,1.6-3.6,3.6-3.6h23.4V9.5H20.3   c-6,0-10.8,4.8-10.8,10.8v59.4c0,6,4.8,10.8,10.8,10.8h59.4c6,0,10.8-4.8,10.8-10.8V56.3h-7.2V79.7z" fill="var(--color-accent-1)"></path>
                    <polygon fill="var(--color-accent-1)" points="56.3,9.5 56.3,16.7 78.2,16.7 49.9,45 55,50.1 83.3,21.8 83.3,43.7 90.5,43.7 90.5,9.5  "></polygon>
                  </g>
                </svg>
              </div>
            </a>
            <a href="mailto:biuro@twojsklep.pl?subject=Zapytanie o produkt: {{ title }}" title="Przejdź do sklepu" class="button-anim btn-write magnetic mt-2 fade-in" data-strength="40">
              <div class="button-anim-text">
                <span>Zapytaj o produkt</span>
                <span>Zapytaj o produkt</span>
              </div>
              <div class="button-anim-icon">
                <svg height="18" viewBox="0 0 100 100" width="18" xmlns="http://www.w3.org/2000/svg" class="icon-link" style="enable-background:new 0 0 100 100" version="1.1" x="0px" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px">
                  <g>
                    <path d="M83.3,79.7c0,2-1.6,3.6-3.6,3.6H20.3c-2,0-3.6-1.6-3.6-3.6V20.3c0-2,1.6-3.6,3.6-3.6h23.4V9.5H20.3   c-6,0-10.8,4.8-10.8,10.8v59.4c0,6,4.8,10.8,10.8,10.8h59.4c6,0,10.8-4.8,10.8-10.8V56.3h-7.2V79.7z" fill="var(--color-accent-1)"></path>
                    <polygon fill="var(--color-accent-1)" points="56.3,9.5 56.3,16.7 78.2,16.7 49.9,45 55,50.1 83.3,21.8 83.3,43.7 90.5,43.7 90.5,9.5  "></polygon>
                  </g>
                </svg>
              </div>
            </a>

          </div>

          <div class="trust-badges">
            <p>Gwarancja bezpiecznych zakupów</p>
          </div>
        </div>
      </div>

      <div class="product-details rounded-md bg-light-2 py-3 px-5 mt-5">
        <section class="details-tab">
          <h2 class="section-title">Szczegóły produktu</h2>
          
          <div class="specs-grid bg-light-1 p-4">
            <div class="spec-item small">
              <strong>Materiał:</strong> {{ material }}
            </div>
            <div class="spec-item small">
              <strong>Proces produkcji:</strong> {{ process }}
            </div>
            <div class="spec-item small">
              <strong>Montaż:</strong> 
              Trudność {{ installation.difficulty }}/5 | Wymagany profesjonalista: {{ "Tak" if installation.professional_required else "Nie" }}
            </div>
            <div class="spec-item small">
              <strong>Waga:</strong> {{ weight }}
            </div>
          </div>

          <div class="description-content">
            {{ content | safe }}
          </div>
        </section>

      </div>

      </div>
    </div>
  </div>
</article>

<div class="lightbox" id="lightbox" aria-hidden="true">
  <div class="lightbox-backdrop" data-lightbox-close></div>
  <div class="lightbox-content" role="dialog" aria-modal="true" aria-label="Zdjęcie produktu">
    <button type="button" class="lightbox-close" data-lightbox-close>Zamknij</button>
    <img src="" alt="" class="lightbox-image" id="lightbox-image">
  </div>
</div>

<style>

/* Typografia i Tekst */
.product-short-description {
  margin-bottom: 20px;
  color: var(--text-main);
}

/* Galeria */
.main-image {
  width: 100%;
  height: auto;
  object-fit: cover;
  border-radius: 15px;
  border: 1px solid #9992;
}

.gallery-thumbs {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 10px;
  margin-top: 12px;
}

.thumb-image {
  width: 100%;
  height: 80px;
  object-fit: cover;
  border-radius: var(--radius);
  cursor: pointer;
  transition: opacity 0.2s;
}

.thumb-image:hover { opacity: 0.8; }

/* Cena */
.product-price {
  margin: 25px 0;
  color: var(--color-accent-1);
  display: flex;
  align-items: baseline;
  gap: 10px;
}

/* Przyciski */
.actions {
  display: flex;
  gap: 15px;
  margin: 30px 0;
}

.btn-primary, .btn-secondary {
  flex: 1;
  padding: 16px 20px;
  text-align: center;
  font-weight: bold;
  text-decoration: none;
  border-radius: 4px;
  text-transform: uppercase;
  font-size: 0.9rem;
  transition: all 0.2s;
}

.btn-primary { background: var(--primary-color); color: #fff; }
.btn-secondary { background: #fff; color: var(--primary-color); border: 2px solid var(--primary-color); }

.btn-primary:hover { background: #333; }
.btn-secondary:hover { background: var(--bg-light); }

/* Specyfikacja */
.specs-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.spec-item strong {
  display: block;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  margin-bottom: 5px;
}

.description-content ul {
  padding-left: 0; /* Resetujemy domyślny padding */
  margin-bottom: 20px;
  list-style: none; /* Wyłączamy standardowe kropki */
}

.description-content ul li {
  position: relative;
  padding-left: 1.5em; 
  margin-bottom: 0.3em;
  line-height: 1.6;
}

.description-content ul li,
.description-content p {
  font-size: 90%;
}

.description-content ul li::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0.6em; 
  width: 6px;
  height: 6px;
  background-color: var(--accent-color, #d32f2f); 
  border-radius: 50%; 
  display: inline-block;
}

.breadcrumb a {
   font-size: 12px;
}

/* Lightbox */
.lightbox { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 9999; }
.lightbox.is-open { display: flex; }
.lightbox-backdrop { position: absolute; inset: 0; background: rgba(0, 0, 0, 0.85); }
.lightbox-content { position: relative; z-index: 1; max-width: 90vw; }
.lightbox-image { max-height: 85vh; border-radius: 15px; }
.lightbox-close { position: absolute; top: -40px; right: 0; color: #fff; background: none; border: 0; font-size: 1rem; cursor: pointer; }

@media (max-width: 768px) {
  .actions { flex-direction: column; }
  .product-price { justify-content: center; }
  .product-title { text-align: center; }
}
</style>

<script>
/* ... (kod JS pozostaje bez zmian, działa poprawnie) ... */
</script>

{% include "partials/footer.njk" %}
